require("zTree")
install.packages("zTree")
#####################################################################
# PEAD Analysis Script
#####################################################################
rm(list=ls()) # Clears memory
graphics.off() # Closes all plot windows
##### Parameters
#~~~ Specify full path and file name of source files ~~~#
#SourceFiles<-c("D:/Institut/#CurrentWork/WhatIsRiskMarket/Results/161212_1032_1_R.xls","D:/Institut/#CurrentWork/WhatIsRiskMarket/Results/161212_1032_2_R.xls","D:/Institut/#CurrentWork/WhatIsRiskMarket/Results/161212_1032_3_R.xls")
SourceFiles<-list.files("D:/Institut/#CurrentWork/PEAD/Results/FilesForAnalysis.",pattern="[0-9]{6}_[0-9]{4}.xls",full.names=T,recursive=F)
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
#####################################################################
# PEAD Analysis Script
#####################################################################
rm(list=ls()) # Clears memory
graphics.off() # Closes all plot windows
##### Parameters
#~~~ Specify full path and file name of source files ~~~#
#SourceFiles<-c("D:/Institut/#CurrentWork/WhatIsRiskMarket/Results/161212_1032_1_R.xls","D:/Institut/#CurrentWork/WhatIsRiskMarket/Results/161212_1032_2_R.xls","D:/Institut/#CurrentWork/WhatIsRiskMarket/Results/161212_1032_3_R.xls")
SourceFiles<-list.files("D:/Institut/#CurrentWork/PEAD/Results/FilesForAnalysis.",pattern="[0-9]{6}_[0-9]{4}.xls",full.names=T,recursive=F)
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
require("zTree")
#source("D:/Institut/#CurrentWork/GIMS/zTree.R") # Loads R import script by Oliver Kirchkamp (https://www.kirchkamp.de//lab/zTree.html#zTreeR)
##### Data preparation
RawData<-zTreeTables(SourceFiles,tables=Tables)    #Reads data
Tables<-c("globals","PEADsignals","subjects","summary","timelog","transactions", "contracts", "dividends", "endowments", "offers", "results", "marketsummary", "session", "layout", "profit")
RemovePracticePeriodTables<-Tables[!Tables=="contracts"&!Tables=="session"] # Subset of tables which the practice period should be removed from. This includes only tables which have life < session.
ShowPlots<-T # Should plots be shown on screen or only written to disk?
RemovePracticePeriods<-T
PlotFileType<-"jpeg"
require("zTree")
#source("D:/Institut/#CurrentWork/GIMS/zTree.R") # Loads R import script by Oliver Kirchkamp (https://www.kirchkamp.de//lab/zTree.html#zTreeR)
##### Data preparation
RawData<-zTreeTables(SourceFiles,tables=Tables)    #Reads data
RawQuestionnaires<-zTreeSbj(QSourceFiles)    #Reads questionnaire data
Data<-RawData # Generates working copy
Q<-RawQuestionnaires
RawQuestionnaires<-zTreeSbj(SourceFiles)
QSourceFiles<-list.files("D:/Institut/#CurrentWork/PEAD/Results/FilesForAnalysis.",pattern="[0-9]{6}_[0-9]{4}.sbj",full.names=T,recursive=F)
#~~
rm(list=ls()) # Clears memory
graphics.off() # Closes all plot windows
##### Parameters
#~~~ Specify full path and file name of source files ~~~#
#SourceFiles<-c("D:/Institut/#CurrentWork/WhatIsRiskMarket/Results/161212_1032_1_R.xls","D:/Institut/#CurrentWork/WhatIsRiskMarket/Results/161212_1032_2_R.xls","D:/Institut/#CurrentWork/WhatIsRiskMarket/Results/161212_1032_3_R.xls")
SourceFiles<-list.files("D:/Institut/#CurrentWork/PEAD/Results/FilesForAnalysis.",pattern="[0-9]{6}_[0-9]{4}.xls",full.names=T,recursive=F)
QSourceFiles<-list.files("D:/Institut/#CurrentWork/PEAD/Results/FilesForAnalysis.",pattern="[0-9]{6}_[0-9]{4}.sbj",full.names=T,recursive=F)
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
Tables<-c("globals","PEADsignals","subjects","summary","timelog","transactions", "contracts", "dividends", "endowments", "offers", "results", "marketsummary", "session", "layout", "profit")
RemovePracticePeriodTables<-Tables[!Tables=="contracts"&!Tables=="session"] # Subset of tables which the practice period should be removed from. This includes only tables which have life < session.
ShowPlots<-T # Should plots be shown on screen or only written to disk?
RemovePracticePeriods<-T
PlotFileType<-"jpeg"
##### Preparing workspace and necessary packages
#install.packages("zTree")
#library("zTree")
require("zTree")
#source("D:/Institut/#CurrentWork/GIMS/zTree.R") # Loads R import script by Oliver Kirchkamp (https://www.kirchkamp.de//lab/zTree.html#zTreeR)
##### Data preparation
RawData<-zTreeTables(SourceFiles,tables=Tables)    #Reads data
RawQuestionnaires<-zTreeSbj(QSourceFiles)    #Reads questionnaire data
Data<-RawData # Generates working copy
Q<-RawQuestionnaires
